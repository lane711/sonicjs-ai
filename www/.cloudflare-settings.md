# Cloudflare Workers/Pages Build Settings

⚠️ **IMPORTANT**: This project uses **OpenNext for Cloudflare**, NOT standard Next.js deployment.

## Build Settings in Cloudflare Dashboard

### Framework Preset
**None** (or select "Custom")

### Build command
```
npx @opennextjs/cloudflare build
```

**Alternative (using package.json script):**
```
npm run deploy
```

**❌ DO NOT USE:**
- `npx next build && npx next export` (deprecated and wrong)
- `next export` (causes the error you're seeing)
- `npm run build` (only builds Next.js, doesn't create Worker)

### Build output directory
```
.open-next
```

**NOT** `.next` - OpenNext creates a different output structure

### Root directory
```
/
```

## Environment Variables

### Node.js Version
Add this environment variable:

**Variable name:** `NODE_VERSION`
**Value:** `20.18.0`

Or use:

**Variable name:** `NODE_VERSION`
**Value:** `20`

## Advanced Settings

### Node.js Version (Alternative Method)
If the environment variable doesn't work, Cloudflare will read from:
- `.node-version` file (already created)
- `.nvmrc` file (already created)
- `package.json` engines field (already configured)

## Branch Deployments

### Production Branch
`main`

### Preview Branches
Enable preview deployments for all branches (optional)

## Build Configuration

Cloudflare will automatically detect:
- Next.js 15
- App Router architecture
- TypeScript
- Tailwind CSS

## Post-Deployment

After deployment, your site will be available at:
- Production: `https://sonicjs-docs.pages.dev`
- Custom domain: Configure in Cloudflare Pages dashboard

## Verification

After deployment, verify:
1. Site loads correctly
2. Navigation works
3. Search functionality works
4. All pages render properly
5. Images and assets load

## Troubleshooting

If build fails, check:
1. Node.js version is 20.0.0 or higher
2. Build command is correct (no `next export`)
3. All dependencies install successfully
4. No TypeScript errors

## Support

- [Cloudflare Pages Docs](https://developers.cloudflare.com/pages/)
- [Next.js on Cloudflare](https://developers.cloudflare.com/pages/framework-guides/nextjs/)
